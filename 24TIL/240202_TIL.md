# 0202 TIL

데이터 베이스에 문제가 생긴다면 어떻게 될까?

회원가입, 로그인부터 CRUD에 관한 모든 작업들이 안될것. 

따라서 DB는 견고하게 유지되어야 함



견고하게 유지하려면 어떻게 해야할까?

바로, DB를 다중화 하는 것



## 데이터 베이스의 다중화

- DB 서버에서 주(master) 서버와 부(slave) 서버를 설정
- Master에서는 데이터 원본만을 취급하며, 주 서버에서만 **C,U,D**를 작업
- Slave 서버에서는 Master 원본을 복사하여 받아 **읽기 작업(R)** 만을 수행

<img src="https://github.com/dofl8787/dofl8787/assets/96863180/867f6928-0f70-4916-a701-b72265613d04" width="500px"/>



일반적으로 DB에 요청되는 연산은 쓰기 연산보다 읽기 연산이 더 많기 때문에, **Slave 서버가 Master 서버보다 더 많다**. 



##### DB 다중화의 장점

- **더 나은 성능** | 읽기 연산이 Slave 서버로 분산되며 병렬로 처리될 수 있는 쿼리 수가 증가하여 성능이 좋아진다.
- **안정성** | DB가 일부 손상되더라도 여러 리전에 다중화 시켜놓을 수 있기 때문에, 일부가 파괴되더라도 데이터의 보존이 보장된다.
- **가용성** | 일부 DB 서버에 장애가 발생하더라도, 다른 서버에서 가져와 빠른 정상화가 가능하다.



###### 만약, 하나의 DB 서버가 다운된다면?

1.  주 서버가 다운되었을 경우
   1) 한 개의 Slave 서버만 가지고 있을 때
      - 모든 연산(읽기 연산 포함)을 한시적으로 Slave DB가 처리(새로운 Master 서버로 설정) + 새로운 Slave DB 생성 후 장애 대응
   2) N개의 Slave 서버가 존재할 때
      - Slave 서버중 하나를 Master 서버로 설정, 나머지 Slave 서버들은 새로운 Master 서버를 복제하여 적용. + 새로운 Slave DB 생성 
2. 부 서버가 다운되었을 경우
   1. 한 개의 Slave 서버가 존재할 때
      - 읽기 연산은 한시적으로 모두 주 DB로 전달 + 새로운 Slave DB 생성 후 장애 서버 대체
   2. N 개의 Slave 서버가 존재할 때
      - 읽기 연산은 나머지 Slave DB 서버들로 분산 + 새로운 Slave DB 생성 후 장애 서버 대체